\NeedsTeXFormat{LaTeX2e}[2020/12/01]
\ProvidesPackage{itaca}
  [lo .sty per il libro di ItaCa]


\RequirePackage{xparse}

\ExplSyntaxOn
\NewDocumentCommand{\makeabbrev}{mmm}
 {
  \yoruk_makeabbrev:nnn { #1 } { #2 } { #3 }
 }

\cs_new_protected:Npn \yoruk_makeabbrev:nnn #1 #2 #3
 {
  \clist_map_inline:nn { #3 }
   {
    \cs_new_protected:cpn { #2 } { #1 { ##1 } }
   }
 }
\ExplSyntaxOff

\makeabbrev{\textbf}{bf#1}{
  a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,%
  A,B,C,D,E,G,H,I,J,K,L,M,N,O,P,Q,R,T,U,V,W,X,Y,Z }
\makeabbrev{\boldsymbol}{bs#1}{%
    a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,%
    A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z }
\makeabbrev{\mathsf}{sf#1}{
  a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,%
  A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z }
\makeabbrev{\mathfrak}{fk#1}{
  a,b,c,d,e,f,g,h,j,k,i,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,%
  A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z }
\makeabbrev{\mathcal}{cl#1}{
  A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z }
\makeabbrev{\mathbb}{bb#1}{
  A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z }
\makeabbrev{\underline}{u#1}{
  a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,
  A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z }

\RequirePackage{amsthm}
\RequirePackage[utf8x]{inputenc}
\RequirePackage[T2A]{fontenc}
\RequirePackage[svgnames]{xcolor}
\RequirePackage[pdftex]{graphicx}
\RequirePackage{ amsfonts
               , amsmath
               , amssymb
               , caption
               , epigraph
               , enumitem
               , microtype
               , mathtools
               , hyphenat
               , todonotes
               , stackrel
               , savesym
               , setspace
               , stmaryrd
               , tikz-cd
               , tcolorbox
               , verbatim
               , calligra
               }

\RequirePackage{tikz}
	\usetikzlibrary{calc}
	\usetikzlibrary{matrix,arrows}

% teste dei diagrammi
\tikzset{commutative diagrams/.cd,arrow style=tikz,diagrams={>=stealth'}}


% classi di frecce
\let\mono\hookrightarrow
\let\epi\twoheadrightarrow


% teoremi

\makeatletter
\def\defthm#1#2{%
  \newtheorem{#1}{#2}[section]%
  \expandafter\def\csname #1autorefname\endcsname{#2}%
  \expandafter\let\csname c@#1\endcsname\c@theorem}
\makeatother

\theoremstyle{definition}
\numberwithin{equation}{section}
\newtheorem{theorem}{Teorema}[section]
 \defthm{corollary}{Corollario}
 \defthm{proposition}{Proposizione}
 \defthm{lemma}{Lemma}
 \defthm{definition}{Definizione}
 \defthm{notation}{Notazione}
 \defthm{remark}{Osservazione}
 \defthm{conjecture}{Congettura}
 \defthm{axiom}{Assioma}
 \defthm{example}{Esempio}
 \defthm{examples}{Esempi}
 \defthm{exercise}{Esercizio}
 \defthm{exercises}{Esercizi}
 \defthm{counterexample}{Controesempio}
 \defthm{construction}{Costruzione}
 \defthm{warning}{Caveat}
 \defthm{digression}{Digressione}
 \defthm{perspective}{Prospettiva}
 \defthm{discussion}{Discussione}
 \defthm{terminology}{Terminologia}
 \defthm{heuristics}{Euristica}

\ProcessOptions\relax

% alcuni diagrammi celebri
\newcommand{\tSquare}[4]{
  \begin{tikzcd}[ampersand replacement=\&]
    #1 \ar[r]\ar[d]\& #2 \ar[d]\\
    #3 \ar[r] \& #4 \\
  \end{tikzcd}
}

\newcommand{\umpProduct}[4]{
  \begin{tikzcd}[ampersand replacement=\&]
    \& #1 \& \\
    #2 \& #2 \times #4 \& #4 \\
  \end{tikzcd}
}